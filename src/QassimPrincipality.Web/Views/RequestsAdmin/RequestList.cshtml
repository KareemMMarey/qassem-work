@using QassimPrincipality.Application.Services.Main.UploadRequest.Dto
@using QassimPrincipality.Web.Helpers.TagHelpers

@model UploadRequestSearchDto;
@{
    ViewBag.Title = "قائمة الطلبات";
    Layout = "_Layout";
}

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">الرئيسية</a></li>
        <li class="breadcrumb-item active"> @ViewBag.Title</li>
    </ol>
</nav>

<div class="row justify-content-xxl-center">
    <div class="col-xxl-12">
        <div class="page-panel">
            <h3 class="page-title margin-bottom-lg"> @ViewBag.Title </h3>
            <div class="list-search" id="elementToToggle">
                <div class="idm-search">
                    
                    @*<button class="idm-filter" id="toggleButton">
                    <svg xmlns="http://www.w3.org/2000/svg" id="Iconly_Light-outline_Filter_2" data-name="Iconly/Light-outline/Filter 2" width="18" height="18" viewBox="0 0 18 18">
                    <g id="Filter_2" data-name="Filter 2">
                    <path id="Filter_2-2" data-name="Filter 2" d="M6.734,18a.629.629,0,0,1-.628-.628V10.8L.5,4.613A1.927,1.927,0,0,1,.007,3.481L0,3.323V1.9A1.881,1.881,0,0,1,1.859,0H16.141A1.881,1.881,0,0,1,18,1.9V3.29a1.93,1.93,0,0,1-.549,1.349L11.36,10.814V15.49a.625.625,0,0,1-.282.524L11,16.057,7,17.94A.625.625,0,0,1,6.734,18ZM1.859,1.256a.625.625,0,0,0-.6.643V3.323a.66.66,0,0,0,.17.447L7.2,10.135a.625.625,0,0,1,.163.422v5.824l2.743-1.29V10.557a.625.625,0,0,1,.117-.366l.063-.075,6.272-6.36a.666.666,0,0,0,.187-.466V1.9a.625.625,0,0,0-.6-.643Z" fill="#fff" />
                    </g>
                    </svg>
                    تصفية
                    </button>*@
                    <form asp-controller="RequestsAdmin" asp-action="RequestList" method="get" >
                        <div class="row g-3 align-items-center margin-bottom-lg">
                            <div class="col-auto">
                                <label class="col-form-label">أنواع الطلبات</label>
                            </div>
                            <div class="col-auto">
                                <select id="type" name="type" onchange="this.form.submit()" asp-items="@ViewBag.items"
                                        class="form-control">
                                </select>
                            </div>
                        </div>
                        @*  <div class="form-group">
                            <div class="col-12 mb-3">
                                <select id="type" name="type">
                                    <option value="1" >طلبات منتهية بالموافقة</option>
                                    <option value="0" >طلبات منتهية بالرفض</option>
                                    <option value="2" >طلبات قيد الإجراء</option>
                                    <option value="3" > كل الطلبات </option>
                                </select>
                            </div>
                        </div> *@
             
                    </form>
                </div>
        
            </div>

            @if (Model.TotalItemsCount > 0)
            {
                <div class="idm-table">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>عنوان الطلب</th>
                                <th>مقدم الطلب</th>
                                <th>تاريخ الطلب</th>
                                <th>حالة الطلب</th>
                                <th style="width:80px"></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var request in Model.Items)
                            {
                                <tr>
                                    <td >@(request.RequestName ?? "--")</td>
                                    <td >@(request.CreatedByFullName ?? "--")</td>
                                    <td >@request.RequestDate</td>
                                    @switch (request.IsApproved)
                                    {
                                        case true :
                                            <td >
                                                <span class="badge text-bg-success">تمت الموافقة</span>
                                            </td>
                                            break;
                                        case false :
                                            <td >
                                                <span class="badge text-bg-danger">مرفوض</span>
                                            </td>
                                            break;
                                        default:
                                            <td >
                                                <span class="badge text-bg-info">الطلب تحت الإجراء</span>
                                            </td>
                                            break;
                                    }
                           

                                    <td>
                                        <a class="btn btn-sm" asp-action="Details" asp-route-requestId="@request.Id" asp->
                                            <svg width="24" height="24">
                                                <use xlink:href="/assets/images/svg-icons.svg#view"></use>
                                            </svg>
                                        </a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <div class="empty-state">
                    <div class="empty-state__icon">
                        <svg>
                            <use xlink:href="/assets/images/svg-icons.svg#no-search-result"></use>
                        </svg>
                    </div>
                    <div class="empty-state__title"> لا يوجد بيانات </div>
                </div>
            }
            <div class="margin-top-xxl">
                @await Html.PartialAsync("Common/Pager", new Pager { Action = "RequestList", PageSize = 10, TotalCount = Model.TotalItemsCount, EnableSearch = true, Search = ViewBag.Search })
            </div>
        </div>
    </div>
</div>