@using QassimPrincipality.Application.Services.Main.OpenData
@using QassimPrincipality.Web.Helpers.TagHelpers

@model OpenDataRequestSearchDto;
@{
    ViewBag.Title = "قائمة الطلبات";
    Layout = "_Layout";
}

<br />


<div class="list">
    <div class="list-search" id="elementToToggle">
        <div class="idm-search">
            @*<button class="idm-filter" id="toggleButton">
            <svg xmlns="http://www.w3.org/2000/svg" id="Iconly_Light-outline_Filter_2" data-name="Iconly/Light-outline/Filter 2" width="18" height="18" viewBox="0 0 18 18">
            <g id="Filter_2" data-name="Filter 2">
            <path id="Filter_2-2" data-name="Filter 2" d="M6.734,18a.629.629,0,0,1-.628-.628V10.8L.5,4.613A1.927,1.927,0,0,1,.007,3.481L0,3.323V1.9A1.881,1.881,0,0,1,1.859,0H16.141A1.881,1.881,0,0,1,18,1.9V3.29a1.93,1.93,0,0,1-.549,1.349L11.36,10.814V15.49a.625.625,0,0,1-.282.524L11,16.057,7,17.94A.625.625,0,0,1,6.734,18ZM1.859,1.256a.625.625,0,0,0-.6.643V3.323a.66.66,0,0,0,.17.447L7.2,10.135a.625.625,0,0,1,.163.422v5.824l2.743-1.29V10.557a.625.625,0,0,1,.117-.366l.063-.075,6.272-6.36a.666.666,0,0,0,.187-.466V1.9a.625.625,0,0,0-.6-.643Z" fill="#fff" />
            </g>
            </svg>
            تصفية
            </button>*@

            <form asp-controller="RequestsAdmin" asp-action="RequestList" method="get">
                @*  <div class="form-group">
                <div class="col-12 mb-3">
                <select id="type" name="type">
                <option value="1" >طلبات منتهية بالموافقة</option>
                <option value="0" >طلبات منتهية بالرفض</option>
                <option value="2" >طلبات قيد الإجراء</option>
                <option value="3" > كل الطلبات </option>
                </select>
                </div>
                </div> *@

                <select id="type" name="type" onchange="this.form.submit()" asp-items="@ViewBag.items"
                        class="form-control">
                </select>


            </form>
        </div>

    </div>

    @if (Model.TotalItemsCount > 0)
    {
        <div class="idm-table">
            <table>
                <thead>
                    <tr>
                        <th style="width:150px" class="text-center">عنوان الطلب</th>
                        <th style="width:150px" class="text-center">مقدم الطلب</th>
                        <th style="width:150px" class="text-center">تاريخ الطلب</th>
                        <th style="width:150px" class="text-center">حالة الطلب</th>
                        <th style="width:150px"></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var request in Model.Items)
                    {
                        <tr>
                            <td class="text-center">@(request.Title ?? "--")</td>
                            <td class="text-center">@(request.UserFullName ?? "--")</td>
                            <td class="text-center">@request.CreatedOn</td>
                            @switch (request.IsApproved)
                            {
                                case true:
                                    <td class="text-center alert alert-success">تمت الموافقة</td>
                                    break;
                                case false:
                                    <td class="text-center alert alert-danger">مرفوض</td>
                                    break;
                                default:
                                    <td class="text-center  alert alert-info">الطلب تحت الإجراء</td>
                                    break;
                            }


                            <td>

                                <a class="idm-edit" asp-action="Details" asp-route-requestId="@request.Id" asp->
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14.548" height="14.549" viewBox="0 0 14.548 14.549">
                                        <g id="Actions" transform="translate(12.654)">
                                            <g id="Icon_feather-edit" data-name="Icon feather-edit" transform="translate(-11.745)">
                                                <path id="Path_6" data-name="Path 6" d="M13.451,18.4H4.2A1.948,1.948,0,0,1,2.25,16.451V7.2A1.948,1.948,0,0,1,4.2,5.25H8.823a.624.624,0,0,1,0,1.247H4.2a.7.7,0,0,0-.7.7v9.255a.7.7,0,0,0,.7.7h9.255a.7.7,0,0,0,.7-.7V11.823a.624.624,0,1,1,1.247,0v4.628A1.948,1.948,0,0,1,13.451,18.4Z" transform="translate(-3.159 -3.848)" fill="#393c46" />
                                                <path id="Path_7" data-name="Path 7" d="M19.807,2.068a2.026,2.026,0,0,1,1.433,3.458l-6.28,6.28a.623.623,0,0,1-.29.164l-2.644.661a.624.624,0,0,1-.756-.756l.661-2.644a.624.624,0,0,1,.164-.29l6.28-6.28A2.013,2.013,0,0,1,19.807,2.068ZM14.2,10.8l6.158-6.158a.779.779,0,1,0-1.1-1.1L13.1,9.7,12.73,11.17Z" transform="translate(-8.193 -2.068)" fill="#393c46" />
                                            </g>
                                        </g>
                                    </svg>
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
    else
    {
        <div class="" style="text-align: center; padding-top: 25px">لا يوجد بيانات</div>
    }
    <div class="idm-pager">
        @await Html.PartialAsync("Common/Pager", new Pager { Action = "RequestList", PageSize = 10, TotalCount = Model.TotalItemsCount, EnableSearch = true, Search = ViewBag.Search })
    </div>
</div>

