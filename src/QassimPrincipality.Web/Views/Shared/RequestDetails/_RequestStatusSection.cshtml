@model QassimPrincipality.Application.Dtos.ServiceRequestDto
@{
    // Try to pull the parent’s localizer out of ViewData
    var localizer = ViewData["ParentLocalizer"] as IViewLocalizer
                    ?? throw new InvalidOperationException("ParentLocalizer not found.");
}

@using QassimPrincipality.Web.Helpers.Business


<div class="col‐md‐4">
    <div class="section‐box">
        <h5 class="mb-3">@localizer["RequestStatus"]</h5>
        <div class="timeline">
            @*
            نعرض كل Action كمحطة في الـ timeline، أصغر خطوة في الأعلى.
            الفعل نفسه (ActionDescription) يأتي من WorkFlowHelper.GetActionDescription(...)
            *@
            @if (Model.Actions != null && Model.Actions.Any())
            {
                @foreach (var action in Model.Actions.OrderBy(a => a.ActionDate))
                {
                    <div class="timeline‐item">
                        <div class="pe-3">
                            <p class="mb-1">
                                <strong>
                                    @WorkFlowHelper.GetActionDescription(
                                             action.ActionStatus,
                                             Model.RequestNumber,
                                             localizer
                                             )
                                </strong>
                            </p>
                            <p class="time">@action.ActionDate.ToString("yyyy-MM-dd HH:mm")</p>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="text-muted small">
                    @localizer["NoActionsYet"]  @* هذا مفتاح جديد: "NoActionsYet" => "لم يتم بعد اتخاذ أي إجراء" *@
                </div>
            }
        </div>
    </div>
</div>
